Bootstrap: debootstrap
OSVersion: bionic
MirrorURL: http://us.archive.ubuntu.com/ubuntu/

%post
  cat >>/etc/apt/sources.list <<EOF
deb http://us.archive.ubuntu.com/ubuntu/ bionic main restricted
deb http://us.archive.ubuntu.com/ubuntu/ bionic-updates main restricted
deb http://us.archive.ubuntu.com/ubuntu/ bionic universe
deb http://us.archive.ubuntu.com/ubuntu/ bionic-updates universe
deb http://us.archive.ubuntu.com/ubuntu/ bionic multiverse
deb http://us.archive.ubuntu.com/ubuntu/ bionic-updates multiverse
deb http://us.archive.ubuntu.com/ubuntu/ bionic-backports main restricted universe multiverse
deb http://security.ubuntu.com/ubuntu bionic-security main restricted
deb http://security.ubuntu.com/ubuntu bionic-security universe
deb http://security.ubuntu.com/ubuntu bionic-security multiverse
EOF
        apt-get -y update
        apt-get -y install xpra xterm less python-numpy python3-numpy
        printf "#!/bin/sh\nxpra start --systemd-run=no --user=\$USER --start-via-proxy=no --start-on-connect=xterm --notifications=no \"\$@\"\n"  >> /usr/bin/custom-xpra-server-start
        printf "#!/bin/sh\nxpra attach --opengl=no --no-printing --notifications=no --webcam=no\n \"\$@\"" >> /usr/bin/custom-xpra-attach
        chmod +x /usr/bin/custom-xpra-server-start /usr/bin/custom-xpra-attach

%help
This is a Singularity container intended to run Xpra on UCL central HPC clusters.

It is Ubuntu-based, and contains an installation of Xpra and two scripts to abbreviate some awkward commands:

    custom-xpra-server-start
    custom-xpra-attach


